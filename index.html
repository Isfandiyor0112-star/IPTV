<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  <title>Isfandiyor's IPTV</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="p-v">
    <div id="o-v">üîê –í–æ–π–¥–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</div>
    <div class="v-c">
      <video id="v-p" controls autoplay playsinline></video>
    </div>
  </div>
  <div class="s-b">
    <div class="s-h">
      <button id="l-i" class="a-b" onclick="_0xOpen()">–í–æ–π—Ç–∏</button>
      <button id="l-o" class="a-b" onclick="signOut()" style="display:none; background:#444;">–í—ã–π—Ç–∏</button>
      <div class="cats">
        <button onclick="_0xLoad('uz')">UZ</button>
        <button onclick="_0xLoad('ru')">RU</button>
        <button onclick="_0xLoad('sport')">–°–ø–æ—Ä—Ç</button>
      </div>
      <input type="text" class="srch" placeholder="–ü–æ–∏—Å–∫..." oninput="_0xFilter(this.value)">
    </div>
    <div class="s-c">
      <ul class="c-l" id="c-list"></ul>
    </div>
  </div>

 <div id="l-m" class="m-d">
  <div class="m-c">
    <span class="close-btn" onclick="_0xClose()">&times;</span>
    <h3>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h3>
    
    <div class="auth-list">
      <button class="a-b btn-google" onclick="signInWithGoogle()">
        <img src="google.svg" width="20">
        Google
      </button>

      <button class="a-b btn-fb btn-soon">
        <img src="facebook.svg" width="20">
        Facebook
        <span class="soon-badge">–°–ö–û–†–û</span>
      </button>

      <button class="a-b btn-apple btn-soon">
        <img src="apple.svg" width="20" style="filter: invert(1);">
        Apple ID
        <span class="soon-badge">–°–ö–û–†–û</span>
      </button>
    </div>

    <p style="color: #555; font-size: 11px; margin-top: 20px;">
      –î–æ—Å—Ç—É–ø –∫ –∫–∞–Ω–∞–ª–∞–º –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
    </p>
  </div>
</div>


  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

  <script>

         // --- –û–ë–ù–û–í–õ–ï–ù–ù–´–ô –ë–õ–û–ö –° –ö–ê–ù–ê–õ–ê–ú–ò (Base64) - –¢–ï–ü–ï–†–¨ –ù–ê VERCEL ---
    const _0xList = {
      "uz": [
        { "n": "QXFsdm95", "u": "aHR0cHM6Ly9zdHJlYW05Lml0di51ei90L2VVMWp8MXBEYnJHM1NpTENFSTlxaEEvZS8xNzY0NDIxODU3LzEyMDUvdHJhY2tzLXYxYTEvbW9uby5tM3U4" },
        { "n": "RnV0Ym9sIFRW", "u": "aHR0cHM6Ly9pcHR2LXByb3h5LWd1bGVzLnZlcmNlbC5hcHAvY2hhbm5lbC9mdXRib2x0dnV6L2luZGV4Lm0zdTg=" },
        { "n": "U3BvcnQgRkhE", "u": "aHR0cHM6Ly9pcHR2LXByb3h5LWd1bGVzLnZlcmNlbC5hcHAvY2hhbm5lbC9zcG9ydHV6dHYvaW5kZXgubTN1OA==" }
      ],
      "sport": [
        { "n": "IFNldGFudGEgMQ==", "u": "aHR0cHM6Ly9pcHR2LXByb3h5LWd1bGVzLnZlcmNlbC5hcHAvY2hhbm5lbC9zZXRhbnRhMS9pbmRleC5tM3U4" },
        { "n": "IFNldGFudGEgMg==", "u": "aHR0cHM6Ly92b2Quc3BsYXkudXovbGl2ZV9zcGxheS9vcmlnaW5hbC9TZXRhbnRhMkhEL3RyYWNrcy12MWExL21vbm8ubTN1OA==" } 
      ]
    };


    const _0xKey = {
      apiKey: "AIzaSyCpC7UxSbtGq3fZ7k4v4yCVDguFu4MU_nI",
      authDomain: "iptv-8b8f9.firebaseapp.com",
      projectId: "iptv-8b8f9",
      storageBucket: "iptv-8b8f9.firebasestorage.app",
      messagingSenderId: "697245556188",
      appId: "1:697245556188:web:a4c8881c17eac1d76b4319"
    };

    firebase.initializeApp(_0xKey);
    const auth = firebase.auth();
    let hls, _0xAct, _0xAll = [], _0xFilt = [];

    const _0xP = {
      ru: "https://raw.githubusercontent.com/Isfandiyor0112-star/m3u8/refs/heads/main/ru.m3u",
      uz: "https://raw.githubusercontent.com/Isfandiyor0112-star/m3u8/refs/heads/main/uz.m3u",
      sport: "https://raw.githubusercontent.com/Isfandiyor0112-star/m3u8/refs/heads/main/sport_https_only.m3u"
    };

    // –û–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
    const _0xDec = (e) => window.atob(e);
    function _0xOpen() { document.getElementById("l-m").style.display = "flex"; }
    function _0xClose() { document.getElementById("l-m").style.display = "none"; }

    function _0xLoad(c) {
      const l = document.getElementById('c-list');
      l.innerHTML = '<li>...</li>';
      let loc = (_0xList[c] || []).map(i => ({ n: _0xDec(i.n), u: i.u }));
      
      fetch(_0xP[c] + '?t=' + Date.now())
        .then(r => r.text())
        .then(t => {
          const rem = _0xParse(t);
          const m = new Map();
          [...loc, ...rem].forEach(x => { if(!m.has(x.u)) m.set(x.u, x); });
          _0xAll = Array.from(m.values()).sort((a,b) => a.n.localeCompare(b.n));
          _0xFilt = [..._0xAll];
          _0xRender(_0xFilt);
        }).catch(() => _0xRender(loc));
    }

    function _0xParse(t) {
      const lines = t.split('\n'), res = [];
      let n = '';
      lines.forEach(l => {
        l = l.trim();
        if(l.indexOf('#EXTINF:') > -1) n = l.split(',').pop();
        else if(l.indexOf('http') === 0) { if(n) res.push({n, u: btoa(l)}); n = ''; }
      });
      return res;
    }

    function _0xRender(chs) {
      const l = document.getElementById('c-list');
      l.innerHTML = '';
      const isA = !!auth.currentUser;
      chs.forEach(i => {
        const li = document.createElement('li');
        li.className = i.u === _0xAct ? 'active' : '';
        li.innerHTML = `<span>${i.n}</span><span>${!isA ? 'üîê' : ''}</span>`;
        li.onclick = () => {
          if(!isA) return _0xOpen();
          document.getElementById("o-v").style.display = "none";
          _0xAct = i.u;
          _0xPlay(i.u);
          _0xRender(chs);
        };
        l.appendChild(li);
      });
    }

    function _0xPlay(u) {
      const v = document.getElementById('v-p');
      const d = _0xDec(u);
      if(hls) hls.destroy();
      if(Hls.isSupported()) {
        hls = new Hls();
        hls.loadSource(d);
        hls.attachMedia(v);
        hls.on(Hls.Events.MANIFEST_PARSED, () => v.play());
      } else { v.src = d; v.play(); }
    }

    function _0xFilter(q) {
      const f = q.toLowerCase();
      _0xFilt = _0xAll.filter(i => i.n.toLowerCase().includes(f));
      _0xRender(_0xFilt);
    }

    function signInWithGoogle() {
      auth.signInWithPopup(new firebase.auth.GoogleAuthProvider()).then(() => _0xClose());
    }
    function signOut() { auth.signOut(); }

    auth.onAuthStateChanged(u => {
      document.getElementById("l-i").textContent = u ? (u.displayName || "–ü—Ä–æ—Ñ–∏–ª—å") : "–í–æ–π—Ç–∏";
      document.getElementById("l-o").style.display = u ? "block" : "none";
      document.getElementById("o-v").style.display = u ? "none" : "flex";
      _0xRender(_0xFilt);
    });

    window.onload = () => _0xLoad('uz');
  </script>
</body>
</html>







